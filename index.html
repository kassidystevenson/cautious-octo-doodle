<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Water Drop Catch Game</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="game-container">
    <h1>Catch the Water Drops!</h1>
    <div id="score">Score: 0</div>
    <div id="message"></div>
    <canvas id="gameCanvas" width="400" height="600"></canvas>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const messageEl = document.getElementById('message');
    
    let drops = [];
    let score = 0;

    function spawnDrop() {
      const isBad = Math.random() < 0.2; // 20% chance of bad drop
      drops.push({
        x: Math.random() * canvas.width,
        y: 0,
        radius: 15,
        speed: 2 + Math.random() * 3,
        isBad: isBad,
        popping: false,
        popProgress: 0,
        splash: false, // true if splash animation is active
        splashProgress: 0 // 0 to 1 for splash animation
      });
    }

    function drawTeardrop(ctx, x, y, radius, color) {
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(x, y - radius);
      ctx.bezierCurveTo(
        x + radius, y - radius,
        x + radius, y + radius * 0.8,
        x, y + radius * 1.5
      );
      ctx.bezierCurveTo(
        x - radius, y + radius * 0.8,
        x - radius, y - radius,
        x, y - radius
      );
      ctx.closePath();
      ctx.fillStyle = color;
      ctx.shadowColor = "#b3e0ff";
      ctx.shadowBlur = 8;
      ctx.fill();
      ctx.restore();
    }

    function drawSplash(ctx, x, y, progress) {
      // Draw a simple splash: several arcs/ellipses radiating out
      ctx.save();
      const splashColor = "rgba(173,216,230," + (1 - progress) + ")";
      const maxR = 25 + 10 * progress;
      for (let i = 0; i < 6; i++) {
        const angle = (Math.PI * 2 / 6) * i;
        const r = maxR * (0.7 + 0.3 * Math.random());
        ctx.beginPath();
        ctx.ellipse(
          x + Math.cos(angle) * r,
          y + Math.sin(angle) * r * 0.7,
          7 + 5 * progress,
          3 + 2 * progress,
          angle,
          0,
          Math.PI * 2
        );
        ctx.fillStyle = splashColor;
        ctx.fill();
      }
      ctx.restore();
    }

    function drawDrop(drop) {
      ctx.save();
      if (drop.splash) {
        drawSplash(ctx, drop.x, drop.y, drop.splashProgress);
      } else {
        let color = drop.isBad ? "#b0b0b0" : "#87cefa"; // gray for bad, light blue for good
        drawTeardrop(ctx, drop.x, drop.y, drop.radius, color);
      }
      ctx.restore();
    }

    function updateGame() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drops.forEach(drop => {
        if (drop.splash) {
          drop.splashProgress += 0.08;
        } else {
          drop.y += drop.speed;
        }
        drawDrop(drop);
      });
      // Remove drops that are out of bounds or finished splashing
      drops = drops.filter(drop => {
        if (drop.splash) {
          return drop.splashProgress < 1;
        }
        return drop.y < canvas.height;
      });
    }

    canvas.addEventListener('click', e => {
      const rect = canvas.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;
      for (let i = drops.length - 1; i >= 0; i--) {
        const d = drops[i];
        if (d.splash) continue;
        // Use teardrop hit area: check if inside a circle for simplicity
        const dx = d.x - mouseX;
        const dy = d.y - mouseY;
        if (Math.sqrt(dx*dx + dy*dy) < d.radius) {
          // Start splash animation
          d.splash = true;
          d.splashProgress = 0;
          if (d.isBad) {
            score -= 1;
            messageEl.textContent = 'Oops! That was a pollutant!';
          } else {
            score += 1;
            messageEl.textContent = 'Nice catch!';
          }
          scoreEl.textContent = 'Score: ' + score;
          break;
        }
      }
    });

    setInterval(spawnDrop, 800);
    gameLoop();
  </script>
</body>
</html>
